<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>FilterPseudobulkContrasts — FilterPseudobulkContrasts • CellMembrane</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="FilterPseudobulkContrasts — FilterPseudobulkContrasts"><meta property="og:description" content="This is designed to accept a study design defined by a series of logical gates applied to metadata fields, test them for equivalence to some criterion, and then filter pairwise contrasts accordingly."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CellMembrane</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/CellMembrane-Tutorial.html">CellMembrane Tutorial</a>
    </li>
    <li>
      <a href="../articles/Pseudobulking-and-Filtered-Contrasts.html">Pseudobulking-and-Filtered-Contrasts</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/BimberLabInternal/CellMembrane/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>FilterPseudobulkContrasts</h1>
    <small class="dont-index">Source: <a href="https://github.com/BimberLabInternal/CellMembrane/blob/master/R/PseudoBulk.R" class="external-link"><code>R/PseudoBulk.R</code></a></small>
    <div class="hidden name"><code>FilterPseudobulkContrasts.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is designed to accept a study design defined by a series of logical gates applied to metadata fields, test them for equivalence to some criterion, and then filter pairwise contrasts accordingly.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FilterPseudobulkContrasts</span><span class="op">(</span></span>
<span>  logicList <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useRequireIdenticalLogic <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  requireIdenticalFields <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filteredContrastsOutputFile <span class="op">=</span> <span class="st">"./filtered_contrasts.tsv"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-logiclist">logicList<a class="anchor" aria-label="anchor" href="#arg-logiclist"></a></dt>
<dd><p>The list that defines the study design. Please see examples for the setup and use. This list be a list of lists where each sub-list has three entries. The first defines the metadata field (e.g. Tissue or Timepoint) to which the logic gate will be applied. The second defines the logic gate that will be used for that field (one of: all (AND), any (OR), xor, nand, nor, or xnor. The third defines the specific value of the metadata field that will be tested for equivalence against the positive and negative contrasts within the gate.</p></dd>


<dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>a design/model matrix returned by DesignModelMatrix().</p></dd>


<dt id="arg-userequireidenticallogic">useRequireIdenticalLogic<a class="anchor" aria-label="anchor" href="#arg-userequireidenticallogic"></a></dt>
<dd><p>Whether or not to apply require_identical logic using requireIdenticalFields. It is possible to use logic gates to keep metadata fields constant, but using this saves time &amp; effort/iteration.</p></dd>


<dt id="arg-requireidenticalfields">requireIdenticalFields<a class="anchor" aria-label="anchor" href="#arg-requireidenticalfields"></a></dt>
<dd><p>The metadata columns of the SeuratObj that you wish to keep constant. For example: defining "Tissue" in this vector would filter all contrasts comparing Liver to PBMC, as their tissue is not identical.</p></dd>


<dt id="arg-filteredcontrastsoutputfile">filteredContrastsOutputFile<a class="anchor" aria-label="anchor" href="#arg-filteredcontrastsoutputfile"></a></dt>
<dd><p>The file to write the list of filtered contrasts to (one pair of samples per row, separated into their metadata fields).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A dataframe of pairwise contrasts, with column names indicating the directionality (positive vs negative) and associated metadata column (inferred by contrast_columns).</p>
    </div>
    <div id="details">
    <h2>Details</h2>

<table class="table table"><tr><td><strong>Filtered</strong></td><td><em>Reason</em></td><td><strong>positive_contrast_Challenge</strong></td><td><em>positive_contrast_Tissue</em></td><td><strong>positive_contrast_cell_type</strong></td><td><em>positive_contrast_SampleType</em></td><td><strong>negative_contrast_Challenge</strong></td><td><em>negative_contrast_Tissue</em></td><td><strong>negative_contrast_cell_type</strong></td><td><em>negative_contrast_SampleType</em></td></tr><tr><td>yes</td><td>non-identical cell_types</td><td>Mtb</td><td>Spleen</td><td><em><strong>Myeloid</strong></em></td><td>Necropsy</td><td>Mock.challenged</td><td>Spleen</td><td><em><strong>Bcell</strong></em></td><td>Necropsy</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>no</td><td>N/A</td><td>Mtb</td><td>Lung</td><td>T.NK</td><td>Necropsy</td><td>Mock.challenged</td><td>Lung</td><td>T.NK</td><td>Necropsy</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>yes</td><td>fails Challenge xor gate</td><td><em><strong>Mock.challenged</strong></em></td><td>Lung</td><td>T.NK</td><td>Necropsy</td><td><em><strong>Mock.challenged</strong></em></td><td>Lung</td><td>T.NK</td><td>Necropsy</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>yes</td><td>fails SampleType AND gate</td><td>Mock.challenged</td><td>MesLN</td><td>Bcell</td><td><em><strong>Baseline</strong></em></td><td>Mock.challenged</td><td>MesLN</td><td>Bcell</td><td><em><strong>Necropsy</strong></em></td></tr></table></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">#Set up design matrix</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="DesignModelMatrix.html">DesignModelMatrix</a></span><span class="op">(</span><span class="va">pseudobulked_seuratObj</span>, </span></span>
<span class="r-in"><span>                            contrast_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Challenge'</span>, <span class="st">'Tissue'</span>, <span class="st">'cell_type'</span>, <span class="st">'SampleType'</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                            sampleIdCol <span class="op">=</span> <span class="st">'cDNA_ID'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Form the study design. This should be a list of gates (each specified as a list itself) with three elements. </span></span></span>
<span class="r-in"><span><span class="co">#The first element defines the metadata column or field that will be used for filtering. </span></span></span>
<span class="r-in"><span><span class="co">#The second defines the logic gate (AND -&gt; any, OR -&gt; any, xor, xnor, nand, nor). </span></span></span>
<span class="r-in"><span><span class="co">#The third defines the specific value of the metadata field that will be tested for equivalence against the positive and negative contrasts within the gate.</span></span></span>
<span class="r-in"><span><span class="va">logicList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'Challenge'</span>, <span class="st">'xor'</span>, <span class="st">'Mock.challenged'</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'SampleType'</span>, <span class="st">'all'</span>, <span class="st">'Necropsy'</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Finally, enumerate all possible contrasts, then filter and return them according to the study design defined by logicList.</span></span></span>
<span class="r-in"><span><span class="co">#If you want to perform "Like-vs-Like" contrasts (i.e. T cell vs T cell within a cell_type metadata field), specify those columns as required to be identical and set useRequireIdenticalLogic to TRUE.</span></span></span>
<span class="r-in"><span><span class="va">filtered_contrasts</span> <span class="op">&lt;-</span> <span class="fu">FilterPseudobulkContrasts</span><span class="op">(</span>logicList <span class="op">=</span> <span class="va">logicList</span>, </span></span>
<span class="r-in"><span>                                                design <span class="op">=</span> <span class="va">design</span>, </span></span>
<span class="r-in"><span>                                                useRequireIdenticalLogic <span class="op">=</span> <span class="cn">T</span>, </span></span>
<span class="r-in"><span>                                                requireIdenticalFields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Tissue'</span>,<span class="st">'cell_type'</span>, <span class="st">'SampleType'</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                                filteredContrastsOutputFile <span class="op">=</span> <span class="st">'./filtered_contrasts.tsv'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                                </span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

